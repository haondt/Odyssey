@using System.Text
@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public Optional<FrameDirection> Flex { get; set; }

    [Parameter]
    public Optional<FrameTemplate> Template { get; set; }

    [Parameter]
    public Optional<FrameGrid> Grid { get; set; }

    [Parameter]
    public Optional<FrameJustification> Justify { get; set; }

    [Parameter]
    public Optional<FrameAlignment> Align { get; set; }

    [Parameter]
    public Optional<FrameSpacing> Gap { get; set; }

    [Parameter]
    public Optional<FrameSpacing> Padding { get; set; }

    /// <summary>
    /// Supply values for both gap and padding
    /// </summary>
    [Parameter]
    public Optional<FrameSpacing> Spacing { get; set; }

    [Parameter]
    public Optional<string> AddClasses { get; set; }

    protected HashSet<string> _rootClasses = ["frame"];

    protected override void OnInitialized()
    {
        if (Template.TryGetValue(out var template))
            switch(template) 
            {
                case FrameTemplate.ButtonContainer:
                    Flex = Flex.Or(FrameDirection.Row);
                    Justify = Justify.Or(FrameJustification.End);
                    Gap = Gap.Or(FrameSpacing.Line);
                    break;

            }

        if(Flex.TryGetValue(out var flex))
        {
            _rootClasses.Add("frame-flex");
            if (flex.CssClass.TryGetValue(out var flexClass))
                _rootClasses.Add(flexClass);

            if (Justify.Bind(q => q.CssClass).TryGetValue(out var justificationClass))
                _rootClasses.Add(justificationClass);

            if(Align.Or(FrameAlignment.Center).CssClass.TryGetValue(out var alignmentClass))
                _rootClasses.Add(alignmentClass);

            if (Spacing.TryGetValue(out var spacingClass))
            {
                Gap = Gap.Or(spacingClass);
                Padding = Padding.Or(spacingClass);
            }
            if (Gap.Bind(q => q.GapCssClass).TryGetValue(out var gapClass))
                _rootClasses.Add(gapClass);

            if (Padding.Bind(q => q.PaddingCssClass).TryGetValue(out var paddingClass))
                _rootClasses.Add(paddingClass);

        }

        if (Grid.TryGetValue(out var grid))
        {
            _rootClasses.Add("frame-grid");
            if (grid.CssClass.TryGetValue(out var gridClass))
                _rootClasses.Add(gridClass);

            if (Justify.Bind(q => q.CssClass).TryGetValue(out var justificationClass))
                _rootClasses.Add(justificationClass);

            if(Align.Or(FrameAlignment.Center).CssClass.TryGetValue(out var alignmentClass))
                _rootClasses.Add(alignmentClass);

            if (Spacing.TryGetValue(out var spacingClass))
            {
                Gap = Gap.Or(spacingClass);
                Padding = Padding.Or(spacingClass);
            }
            if (Gap.Bind(q => q.GapCssClass).TryGetValue(out var gapClass))
                _rootClasses.Add(gapClass);

            if (Padding.Bind(q => q.PaddingCssClass).TryGetValue(out var paddingClass))
                _rootClasses.Add(paddingClass);
        }

        if (AddClasses.TryGetValue(out var addClasses))
            _rootClasses.Add(addClasses);
    }
}

<div class="@string.Join(' ', _rootClasses)">
    @ChildContent
</div>
